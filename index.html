<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Rick and Morty Database</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Bootstrap es como un ‚Äúcaj√≥n de herramientas‚Äù que nos da colores, tama√±os, filas, columnas y botones listos para usar -->

    <!-- Fuente de Google -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;700&display=swap" rel="stylesheet" />
    <!-- Fuente bonita que se ve moderna -->
</head>

<body class="bg-dark text-light">
    <!-- bg-dark = fondo negro para toda la p√°gina | text-light = texto blanco -->

    <div class="container-fluid min-vh-100 d-flex flex-column">
        <!-- container-fluid = contenedor que ocupa TODO el ancho de la pantalla -->
        <!-- min-vh-100 = altura m√≠nima igual a toda la pantalla -->
        <!-- d-flex flex-column = organizamos todo dentro en columna vertical -->

        <!-- HEADER: Logo + Buscador + Bot√≥n de Favoritos -->
        <header class="row bg-black py-3 align-items-center">
            <!-- row = fila de Bootstrap para dividir en columnas -->
            <!-- bg-black = fondo negro del header -->
            <!-- py-3 = padding arriba y abajo, como ‚Äúespaciado interno‚Äù -->
            <!-- align-items-center = alinear verticalmente todo en el centro -->

            <!-- Columna izquierda: Logo + t√≠tulo -->
            <div class="col-md-6 d-flex align-items-center">
                <!-- col-md-6 = ocupa la mitad de la fila en pantallas medianas o m√°s grandes -->
                <!-- d-flex align-items-center = ponemos logo y texto en fila y centrados verticalmente -->
                <img src="https://rickandmortyapi.com/api/character/avatar/1.jpeg" width="40"
                    class="rounded-circle me-2" />
                <!-- rounded-circle = la imagen es un c√≠rculo -->
                <!-- me-2 = ‚Äúmargin end‚Äù = espacio a la derecha de la imagen -->
                <span class="fw-bold">Rick & Morty Database</span>
                <!-- fw-bold = texto en negrita -->
            </div>

            <!-- Columna derecha: Buscador + bot√≥n favoritos -->
            <div class="col-md-6 d-flex justify-content-end gap-3">
                <!-- col-md-6 = ocupa la otra mitad de la fila -->
                <!-- d-flex justify-content-end = todo contenido alineado a la derecha -->
                <!-- gap-3 = espacio entre elementos -->
                <input id="searchInput" type="text" class="form-control w-50" placeholder="Buscar personaje..." />
                <!-- form-control = input con estilo de Bootstrap, bordes redondeados, altura uniforme -->
                <!-- w-50 = ancho 50% del contenedor padre -->
                <button class="btn btn-outline-warning" onclick="loadFavorites()">‚òÖ</button>
                <!-- btn = bot√≥n de Bootstrap -->
                <!-- btn-outline-warning = bot√≥n con borde amarillo y texto amarillo, fondo transparente -->
            </div>
        </header>

        <div class="row flex-grow-1">
            <!-- row = fila principal debajo del header -->
            <!-- flex-grow-1 = esta fila ocupa todo el espacio restante de la pantalla -->

            <!-- ASIDE: Filtros (sidebar) -->
            <aside class="col-lg-3 col-md-4 border-end border-secondary p-3">
                <!-- col-lg-3 = 3/12 columnas en pantallas grandes | col-md-4 = 4/12 columnas en medianas -->
                <!-- border-end border-secondary = l√≠nea gris separadora a la derecha -->
                <!-- p-3 = padding interno de 1rem en todos los lados -->
                <h5 class="text-info">üîç Filtros</h5>
                <!-- text-info = color azul claro para el t√≠tulo -->

                <!-- Filtro por Estado -->
                <div class="mb-3">
                    <!-- mb-3 = margin bottom = espacio debajo del filtro -->
                    <label class="form-label">Estado</label>
                    <!-- form-label = estilo de Bootstrap para etiquetas -->
                    <select id="statusFilter" class="form-select">
                        <!-- form-select = select estilizado con Bootstrap -->
                        <option value="">Todos</option>
                        <option value="alive">Vivo</option>
                        <option value="dead">Muerto</option>
                        <option value="unknown">Desconocido</option>
                    </select>
                </div>

                <!-- Filtro por Especie -->
                <div class="mb-3">
                    <label class="form-label">Especie</label>
                    <select id="speciesFilter" class="form-select">
                        <option value="">Todas</option>
                        <option value="Human">Humano</option>
                        <option value="Alien">Alien</option>
                    </select>
                </div>

                <!-- Botones aplicar y limpiar filtros -->
                <div class="d-grid gap-2">
                    <!-- d-grid = convierte hijos en bloques con distribuci√≥n vertical autom√°tica -->
                    <!-- gap-2 = espacio entre los botones -->
                    <button class="btn btn-success" onclick="applyFilters()">Aplicar filtros</button>
                    <!-- btn-success = bot√≥n verde -->
                    <button class="btn btn-outline-secondary" onclick="resetFilters()">Limpiar</button>
                    <!-- btn-outline-secondary = bot√≥n gris con borde -->
                </div>
            </aside>

            <!-- MAIN: Parte Jordy, Sebastian y Ariel -->
            <main class="col-lg-9 col-md-8 p-4">
                <!-- col-lg-9 = ocupa 9/12 columnas en grande | col-md-8 = 8/12 en medianas -->
                <!-- p-4 = padding 1.5rem alrededor del main -->

                <!-- CONTENEDOR 1: Bienvenida -->
                <section class="container-fluid bg-secondary text-white p-4 rounded mb-4 shadow-sm">
                    <!-- container-fluid = ocupa todo el ancho de su columna -->
                    <!-- bg-secondary = fondo gris oscuro | text-white = texto blanco -->
                    <!-- p-4 = padding interno | rounded = bordes redondeados | mb-4 = margen inferior | shadow-sm = sombra peque√±a -->
                    <h4>Bienvenido</h4>
                    <p>Explora personajes reales gracias a la API p√∫blica.</p>
                    <span class="badge bg-warning text-dark">Tema: Rick and Morty API</span>
                    <!-- badge = etiqueta resaltada de Bootstrap | bg-warning = amarillo | text-dark = texto negro -->
                </section>

                <!-- CONTENEDOR 2: Contador de personajes -->
                <section class="container-fluid bg-dark border border-secondary rounded p-3 mb-4">
                    <!-- bg-dark = fondo negro | border border-secondary = borde gris | rounded = bordes redondeados -->
                    <!-- p-3 = padding interno | mb-4 = margen inferior -->
                    <h5 class="mb-0">Personajes encontrados (<span id="count">0</span>)</h5>
                    <!-- mb-0 = sin margen inferior, para que quede pegado al borde -->
                </section>

                <!-- Boton de arriba personajes -->
                <section class="container-fluid d-flex justify-content-center mb-4 gap-3">
                    <!-- d-flex = contenedor flexible en fila | justify-content-center = centrar elementos | mb-4 = margen inferior | gap-3 = espacio entre botones -->
                    <button id="prev" class="btn btn-outline-light" disabled onclick="changePage(-1)">Anterior</button>
                    <button id="next" class="btn btn-outline-light" onclick="changePage(1)">Siguiente</button>
                </section>

                <!-- CONTENEDOR 3: Grid de personajes -->
                <section class="container-fluid">
                    <ul id="characters"
                        class="row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-4 g-3 list-unstyled">
                        <!-- row = fila de Bootstrap para el grid -->
                        <!-- row-cols-* = define cu√°ntas columnas seg√∫n tama√±o de pantalla -->
                        <!-- g-3 = gap entre columnas y filas -->
                        <!-- list-unstyled = quitar bullets del ul -->
                        <!-- Las cards se insertan din√°micamente con JS -->
                    </ul>
                </section>

                <!-- Boton de abajo personajes -->
                <section class="container-fluid d-flex justify-content-center mt-4 gap-3">
                    <!-- igual que el bot√≥n de arriba pero con margin-top -->
                    <button id="prev" class="btn btn-outline-light" disabled onclick="changePage(-1)">Anterior</button>
                    <button id="next" class="btn btn-outline-light" onclick="changePage(1)">Siguiente</button>
                </section>

            </main>

        </div>

        <!-- FOOTER -->
        <footer class="bg-black text-center py-2 mt-auto">
            <!-- bg-black = fondo negro | text-center = texto centrado | py-2 = padding vertical | mt-auto = empuja footer abajo -->
            <small>Rick and Morty Database - Proyecto Educativo</small>
        </footer>

    </div>

    <!-- SCRIPT -->
    <script>
        // Variables globales
        let page = 1;          // P√°gina actual
        let currentData = [];  // Datos actuales de la API
        let favorites = [];    // Personajes favoritos

        const list = document.getElementById("characters"); // contenedor de personajes
        const count = document.getElementById("count");     // contenedor del contador

        // Funci√≥n para cargar personajes desde la API
        function loadCharacters() {
            fetch(`https://rickandmortyapi.com/api/character/?page=${page}`)
                .then(res => res.json())
                .then(data => {
                    currentData = data.results;      // Guardamos resultados
                    renderCharacters(currentData);   // Renderizamos cards
                    updatePaginationButtons();       // Actualizamos estado de botones
                })
                .catch(err => {
                    console.error("Error al cargar personajes:", err);
                });
        }

        // Funci√≥n para renderizar personajes (solo 12)
        function renderCharacters(data) {
            list.innerHTML = "";                    // Limpiamos contenedor
            const limited = data.slice(0, 12);      // Mostrar m√°ximo 12 personajes
            count.textContent = limited.length;     // Actualizar contador

            limited.forEach(c => {
                list.innerHTML += `
            <li class="col">
                <div class="card h-100 text-center shadow-sm">
                    <div class="ratio ratio-1x1">
                        <img src="${c.image}" class="card-img-top img-fluid" alt="${c.name}">
                    </div>
                    <div class="card-body p-2">
                        <h6 class="card-title mb-2">${c.name}</h6>
                        <ul class="list-group list-group-flush text-start small">
                            <li class="list-group-item py-1">Especie: ${c.species}</li>
                            <li class="list-group-item py-1">Estado: ${c.status}</li>
                            <li class="list-group-item py-1">G√©nero: ${c.gender}</li>
                            <li class="list-group-item py-1">Origen: ${c.origin.name}</li>
                        </ul>
                    </div>
                    <div class="card-footer p-2">
                        <button class="btn btn-warning btn-sm" onclick="addFavorite(${c.id})">‚òÖ Favorito</button>
                    </div>
                </div>
            </li>
            `;
            });
        }

        // Funci√≥n de filtros
        function applyFilters() {
            const status = document.getElementById("statusFilter").value;
            const species = document.getElementById("speciesFilter").value;
            const search = document.getElementById("searchInput").value.toLowerCase();

            const filtered = currentData.filter(c =>
                (status === "" || c.status.toLowerCase() === status) &&
                (species === "" || c.species === species) &&
                c.name.toLowerCase().includes(search)
            );

            renderCharacters(filtered);
        }

        function resetFilters() {
            document.getElementById("statusFilter").value = "";
            document.getElementById("speciesFilter").value = "";
            document.getElementById("searchInput").value = "";
            renderCharacters(currentData);
        }

        // Funci√≥n para cambiar p√°gina
        function changePage(dir) {
            page += dir;
            loadCharacters();
        }

        // Actualiza el estado de todos los botones de paginaci√≥n
        function updatePaginationButtons() {
            document.querySelectorAll(".btn-prev").forEach(btn => btn.disabled = page === 1);
            document.querySelectorAll(".btn-next").forEach(btn => btn.disabled = page === 42); // 42 es n√∫mero de p√°ginas en la API
        }

        // A√±adir a favoritos
        function addFavorite(id) {
            const f = currentData.find(c => c.id === id);
            if (!favorites.some(x => x.id === id)) {
                favorites.push(f);
                alert("A√±adido a favoritos");
            }
        }

        // Cargar solo favoritos
        function loadFavorites() {
            if (favorites.length === 0) {
                alert("No hay favoritos");
                return;
            }
            renderCharacters(favorites);
        }

        // Evento de b√∫squeda en tiempo real
        document.getElementById("searchInput").addEventListener("keyup", applyFilters);

        // Eventos de paginaci√≥n para ambos botones (arriba y abajo)
        document.querySelectorAll(".btn-prev").forEach(btn => {
            btn.addEventListener("click", () => changePage(-1));
        });
        document.querySelectorAll(".btn-next").forEach(btn => {
            btn.addEventListener("click", () => changePage(1));
        });

        // Carga inicial
        loadCharacters();
    </script>

</body>

</html>